<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Doctor Register</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #065f46 0%, #047857 100%);
        }
    </style>
</head>

<body>

<div class="w-full max-w-md bg-white p-8 rounded-2xl shadow-2xl">

    <h2 class="text-3xl font-bold text-center text-green-700 mb-2">
        Doctor Registration
    </h2>

    <p class="text-center text-gray-500 mb-6">
        Create your professional account
    </p>

    <!-- FORM -->
    <div class="space-y-4">

        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
                Full Name
            </label>
            <input type="text" id="d-name"
                   placeholder="Dr. John Smith"
                   class="w-full px-4 py-3 border rounded-lg focus:ring-green-500 focus:border-green-500">
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
                Email
            </label>
            <input type="email" id="d-email"
                   placeholder="doctor@email.com"
                   class="w-full px-4 py-3 border rounded-lg focus:ring-green-500 focus:border-green-500">
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
                Password
            </label>
            <input type="password" id="d-password"
                   placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                   class="w-full px-4 py-3 border rounded-lg focus:ring-green-500 focus:border-green-500">
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
                Specialty
            </label>
            <select id="d-specialty"
                    class="w-full px-4 py-3 border rounded-lg focus:ring-green-500 focus:border-green-500">
                <option>General Physician (GP)</option>
                <option>Otolaryngologist (ENT)</option>
                <option>Gastroenterologist</option>
                <option>Dermatologist</option>
                <option>Orthopedic</option>
            </select>
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
                Experience (Years)
            </label>
            <input type="number" id="d-experience"
                   placeholder="5"
                   class="w-full px-4 py-3 border rounded-lg focus:ring-green-500 focus:border-green-500">
        </div>

        <button onclick="registerDoctor()"
                class="w-full py-3 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition">
            Register
        </button>

        <p class="text-center text-sm mt-4">
            Already registered?
            <a href="/doctor_login" class="text-green-700 font-semibold">
                Login here
            </a>
        </p>

    </div>
</div>


<!-- FIREBASE COMPAT SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>

    // üîê Your Firebase Config
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyB1aeBuOwvpS2ZVCI6oc0LuEyiv7sru7rw",
  authDomain: "healthcare-assistant-688ee.firebaseapp.com",
  projectId: "healthcare-assistant-688ee",
  storageBucket: "healthcare-assistant-688ee.firebasestorage.app",
  messagingSenderId: "890346236226",
  appId: "1:890346236226:web:263c90d1a61648c15780db",
  measurementId: "G-JXV11W4HF6"
};

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    async function registerDoctor() {

        const name = document.getElementById("d-name").value;
        const email = document.getElementById("d-email").value;
        const password = document.getElementById("d-password").value;
        const specialty = document.getElementById("d-specialty").value;
        const experience = document.getElementById("d-experience").value;

        if (!name || !email || !password) {
            alert("Please fill all required fields");
            return;
        }

        try {

            // 1Ô∏è‚É£ Create Firebase User
            const userCredential =
                await auth.createUserWithEmailAndPassword(email, password);

            const user = userCredential.user;

            // 2Ô∏è‚É£ Get Firebase ID Token
            const idToken = await user.getIdToken();

            // 3Ô∏è‚É£ Send Data to Flask Backend
            const response = await fetch("/doctor_firebase_register", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    token: idToken,
                    name: name,
                    specialty: specialty,
                    experience: experience
                })
            });

            const result = await response.json();

            if (result.status === "success") {
                alert("Doctor Registered Successfully!");
                window.location.href = "/doctor_login";
            } else {
                alert("Database Error");
            }

        } catch (error) {
            alert(error.message);
        }
    }

</script>

</body>
</html>