<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Patient Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-br from-violet-800 to-purple-700">

<div class="w-full max-w-md p-8 bg-white rounded-2xl shadow-2xl">
    <h2 class="text-3xl font-bold text-center text-violet-700 mb-6">
        Login
    </h2>

    <div class="space-y-4">
        <input type="email" id="login-email" placeholder="Email"
               class="w-full px-4 py-3 border rounded-lg">

        <input type="password" id="login-password" placeholder="Password"
               class="w-full px-4 py-3 border rounded-lg">

        <button type="button"
                onclick="firebaseLogin()"
                class="w-full py-3 bg-violet-700 text-white font-bold rounded-xl hover:bg-violet-800 transition">
            Login
        </button>
    </div>

    <p class="mt-6 text-center text-sm">
        Don't have an account?
        <a href="{{ url_for('register') }}"
           class="text-green-600 font-semibold">
            Register here
        </a>
    </p>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyB1aeBuOwvpS2ZVCI6oc0LuEyiv7sru7rw",
  authDomain: "healthcare-assistant-688ee.firebaseapp.com",
  projectId: "healthcare-assistant-688ee",
  storageBucket: "healthcare-assistant-688ee.firebasestorage.app",
  messagingSenderId: "890346236226",
  appId: "1:890346236226:web:263c90d1a61648c15780db",
  measurementId: "G-JXV11W4HF6"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

function firebaseLogin() {
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;

    auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => userCredential.user.getIdToken())
        .then(idToken => {
            return fetch("/firebase_login", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({ token: idToken })
            });
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === "success") {
                window.location.href = "/patient_dashboard";
            } else {
                alert("Login failed");
            }
        })
        .catch(error => {
            alert(error.message);
        });
}
</script>

</body>
</html>